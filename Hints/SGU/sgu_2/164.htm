<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=164 -->
<HTML><HEAD><TITLE>Saratov State University :: Online Contester</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<META content=??? name=keywords>
<META content=??? name=description><LINK href="164.files/style-800.css" 
type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2716.2200" name=GENERATOR></HEAD>
<BODY style="FONT-SIZE: 9pt" text=#000000 vLink=#336699 aLink=#336699 
link=#336699 bgColor=#f3f6f9>
<DIV align=center>
<DIV align=center>
<H4>164. Airlines </H4></DIV>
<DIV align=center>time limit per test: 0.4 sec.<BR>memory limit per test: 1024 
KB</DIV>
<DIV align=center>input: standard<BR>output: standard</DIV><BR><BR><BR>
<DIV align=left>Microland country has very big territory, so its citizens always 
travel by air between cities. This is why transporting people by air is very 
profitable in Microland, and some years ago there was exactly one direct air 
flight between any two cities and there had survived only one air company, 
"Microland airlines". But then some Microland states suited it for violating the 
antitrust law and, according to the decision of the court, that company was 
divided into M independent parts, which later become known as "Microland 
airlines 1", "Microland airlines 2" and so on. Every flight previously owned by 
"Microland airlines" became owned by exactly one of its parts. <BR><BR>Now the 
president elections are coming in this country. To increase his rating, current 
president of Microland decided to buy some parts of "Microland airlines" and 
make flights of these companies free. He wants to make it easier to travel from 
any city to any, so for any two cities he wants to make it able to fly from one 
to other making not more than 2 changes, i.e. using not more than 3 free 
flights. In other words, for any two cities A and B: direct flight between these 
cities must be done free, or there must exist a city C so that flights from A to 
C and from C to B will be done free, or there must exist two cities C and D so 
that flights from A to C, from C to D, from D to B will be done free. But, of 
course, the president is avoid of breaking that antitrust law (the court is 
really independent in Microland!). Not to violate it, president has to buy not 
more than ((M+1) div 2) "Microland airlines" parts. <BR><BR>You are working in 
president's team. You are to write a program that will decide, what parts of 
"Microland airlines" the president should buy. </DIV>
<DIV align=left><BR><B>Input</B></DIV>
<DIV align=left>On the first line of input there are two integers N and M 
(1&lt;=N&lt;=200) --- the number of cities in Microland and the number of 
"Microland airlines" parts. Next N lines contain N integers each. i-th integer 
in i-th line is 0; and j-th, if j&lt;&gt;i, is the number of "Microland 
airlines" part which owns direct flight from i-th city to j-th (and from j-th to 
i-th too). Each "Microland airlines" part owns at least one flight. </DIV>
<DIV align=left><BR><B>Output</B></DIV>
<DIV align=left>If the solution exists, write on the first line of output one 
integer --- the number of "Microland airlines" parts that should be bought by 
president. On the second line of output write the numbers of these parts in any 
order. If several solutions exist, output any. If no solutions exist, output 
only one integer "-1". </DIV>
<DIV align=left><BR><B>Sample test(s)</B></DIV>
<DIV align=left><BR>Input</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>4 3 <BR>0 3 2 2 <BR>3 0 1 2 <BR>2 1 0 1 <BR>2 2 1 0 </DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left><BR>Output</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>2 <BR>1 3 </DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left>
<DIV align=right><A href="http://acm.sgu.ru/submit.php?problem=164">[submit]</A> 
</DIV></DIV>
<DIV align=left>
<DIV align=right><A 
href="http://acm.sgu.ru/forum.php?contest=0&amp;problem=164">[forum]</A> 
</DIV></DIV>
<DIV align=left>
<HR>
</DIV>
<TABLE cellSpacing=7 align=left>
  <TBODY>
  <TR>
    <TD>Author:</TD>
    <TD>NNSU #2 team </TD></TR>
  <TR>
    <TD>Resource:</TD>
    <TD>Lazurny olympiad in informatics, 2002 </TD></TR>
  <TR>
    <TD>Date:</TD>
    <TD>July-August 2002 
</TD></TR></TBODY></TABLE><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR>
<TABLE class=tb cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD>
      <TABLE cellSpacing=1 width="100%">
        <TBODY>
        <TR>
          <TD bgColor=#ffffff>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR style="BACKGROUND-COLOR: #ffffff">
                <TD align=left>Server time: 2004-01-13 20:37:46</TD>
                <TD align=right><A href="mailto:acm@cs.sgu.ru" 
                  target=_top>Online Contester</A> Team © 2002 - 2003. All 
                  rights 
  reserved.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV></BODY></HTML>
