<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=205 -->
<HTML><HEAD><TITLE>Saratov State University :: Online Contester</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<META content=??? name=keywords>
<META content=??? name=description><LINK href="205.files/style-800.css" 
type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2716.2200" name=GENERATOR></HEAD>
<BODY style="FONT-SIZE: 9pt" text=#000000 vLink=#336699 aLink=#336699 
link=#336699 bgColor=#f3f6f9>
<DIV align=center>
<DIV align=center>
<H4>205. Quantization Problem </H4></DIV>
<DIV align=center>time limit per test: 2 sec.<BR>memory limit per test: 65536 
KB</DIV>
<DIV align=center>input: standard<BR>output: standard</DIV><BR><BR><BR>
<DIV align=left>When entering some analog data into a computer, this information 
must be quantized. Quantization transforms each measured value x to some other 
value l(x) selected from the predefined set L of levels. Sometimes to reduce the 
influence of the levels set to the information, the group of levels sets 
L<SUB>i</SUB> is used. The number of levels sets is usually chosen to be the 
power of 2. <BR><BR>When using the number of levels sets, some additional 
information should be used to specify which set was used for each quantization. 
However, providing this information may be too expensive — the better solution 
would be to choose more levels and use one set. To avoid the specification of 
the quantization set, the following technique is used. Suppose that n values 
x<SUB>1</SUB>, x<SUB>2</SUB>, ..., x<SUB>n</SUB> are to be quantized and the 
group of m=2<SUP>p</SUP> levels sets L<SUB>i</SUB>, i=0, ..., m-1; each of size 
s=2<SUP>q</SUP> is used to quantize it. After quantization x<SUB>j</SUB> is 
replaced with some number l<SUB>j</SUB> = in L<SUB>f(j)</SUB>. Instead of 
sending l<SUB>j</SUB>, its ordinal number in L<SUB>f(j)</SUB> is usually sent, 
let k<SUB>j</SUB> be the ordinal number of l<SUB>j</SUB> in L<SUB>f(j)</SUB> 
(levels are numbered starting with 0). Take p least significant bits of 
k<SUB>j</SUB> and say that the number k<SUB>j</SUB> &amp; (2<SUP>p</SUP>-1) is 
the number of the levels set that will be used for next quantization, that is 
f(j+1) = k<SUB>j</SUB> &amp; (2<SUP>p</SUP>-1). <BR><BR>Since the least 
significant bits of k<SUB>j</SUB> are usually distributed quite randomly, the 
sets used for quantization change often and weakly depend on values of quantized 
data, thus this technique provides the good way to perform the quantization. 
<BR><BR>Usually to perform the quantization the closest to the value level of 
the levels set is chosen. However, using the technique described, sometimes it 
pays off to choose not the optimal level, but some other one, the ordinal number 
of which has other least significant bits, thus choosing another levels set for 
next measure and providing better approximation of quantized values in the 
future. Let us call the <EM>deviation</EM> of quantization the value of 
sum(j=1.. n, |x<SUB>j</SUB> - l<SUB>j</SUB>|). Your task is given measures and 
levels sets to choose quantized value for each measure in such a way, that the 
deviation of quantization is minimal possible. <BR><BR>The first value is always 
quantized using set L<SUB>0</SUB>. <BR></DIV>
<DIV align=left><BR><B>Input</B></DIV>
<DIV align=left>The first line of the input file contains n (1 &#8804; n &#8804; 1000). The 
second line contains n integer numbers x<SUB>i</SUB> ranging from 1 to 
10<SUP>6</SUP>. The next line contains m and s (1 &#8804; m &#8804; 128, m &#8804; s &#8804; 128). Next 
m lines contain s integer numbers each — levels of the quantization sets given 
in increasing order for each set, all levels satisfy 1 &#8804; level &#8804; 10<SUP>6</SUP>. 
<BR></DIV>
<DIV align=left><BR><B>Output</B></DIV>
<DIV align=left>First output the minimal possible deviation of the quantization. 
Then output n integer numbers in range from 0 to s - 1. For each input value 
output the number of the level in the corresponding levels set (k<SUB>j</SUB>) 
used for this number to achieve the quantization required. <BR></DIV>
<DIV align=left><BR><B>Sample test(s)</B></DIV>
<DIV align=left><BR>Input</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>3 <BR>8 8 19 <BR>2 4 <BR>5 10 15 20 <BR>3 7 13 17 <BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left><BR>Output</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>5 <BR>1 1 3 <BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left>
<DIV align=right><A href="http://acm.sgu.ru/submit.php?problem=205">[submit]</A> 
</DIV></DIV>
<DIV align=left>
<DIV align=right><A 
href="http://acm.sgu.ru/forum.php?contest=0&amp;problem=205">[forum]</A> 
</DIV></DIV>
<DIV align=left>
<HR>
</DIV>
<TABLE cellSpacing=7 align=left>
  <TBODY>
  <TR>
    <TD>Author:</TD>
    <TD>Andrew Stankevich </TD></TR>
  <TR>
    <TD>Resource:</TD>
    <TD>Petrozavodsk Summer Trainings 2003 </TD></TR>
  <TR>
    <TD>Date:</TD>
    <TD>2003-08-23 
</TD></TR></TBODY></TABLE><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR>
<TABLE class=tb cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD>
      <TABLE cellSpacing=1 width="100%">
        <TBODY>
        <TR>
          <TD bgColor=#ffffff>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR style="BACKGROUND-COLOR: #ffffff">
                <TD align=left>Server time: 2004-01-14 13:32:15</TD>
                <TD align=right><A href="mailto:acm@cs.sgu.ru" 
                  target=_top>Online Contester</A> Team © 2002 - 2003. All 
                  rights 
  reserved.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV></BODY></HTML>
