<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=176 -->
<HTML><HEAD><TITLE>Saratov State University :: Online Contester</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<META content=??? name=keywords>
<META content=??? name=description><LINK href="176.files/style-800.css" 
type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2716.2200" name=GENERATOR></HEAD>
<BODY style="FONT-SIZE: 9pt" text=#000000 vLink=#336699 aLink=#336699 
link=#336699 bgColor=#f3f6f9>
<DIV align=center>
<DIV align=center>
<H4>176. Flow construction </H4></DIV>
<DIV align=center>time limit per test: 3 sec.<BR>memory limit per test: 1024 
KB</DIV>
<DIV align=center>input: standard<BR>output: standard</DIV><BR><BR><BR>
<DIV align=left>You have given the net consisting of nodes and pipes; pipes 
connect the nodes. Some substance can flow by pipes, and flow speed in any pipe 
doesn't exceed capacity of this pipe. <BR>The substance cannot be accumulated in 
the nodes. But it is being produced in the first node with the non-negative 
speed and being consumed with the same speed in the last node. <BR>You have some 
subset taken from the set of pipes of this net. You need to start the motion of 
substance in the net, and your motion must fully fill the pipes of the given 
subset. Speed of the producing substance in the first node must be minimal. 
<BR>Calculate this speed and show the scene of substance motion. <BR>Remember 
that substance can't be accumulated in the nodes of the net. </DIV>
<DIV align=left><BR><B>Input</B></DIV>
<DIV align=left>Two positive integer numbers N (1&lt;=N&lt;=100) and M have been 
written in the first line of the input - numbers of nodes and pipes. <BR>There 
are M lines follows: each line contains four integer numbers Ui, Vi, Zi, Ci; the 
numbers are separated by a space. Ui is the beginning of i-th pipe, Vi is its 
end, Zi is a capacity of i-th pipe (1&lt;=Zi&lt;=10^5) and Ci is 1 if i-th pipe 
must be fully filled, and 0 otherwise. <BR>Any pair of nodes can be connected 
only by one pipe. If there is a pipe from node A to node B, then there is no 
pipe from B to A. Not a single node is connected with itself. <BR>There is no 
pipe which connects nodes number 1 and N. Substance can flow only from the 
beginning of a pipe to its end. </DIV>
<DIV align=left><BR><B>Output</B></DIV>
<DIV align=left>Write one integer number in the first line of the output - it 
ought to be the minimal speed of the producing substance in the first node. 
<BR>Write M integers in the second line - i-th number ought to be the flow speed 
in the i-th pipe (numbering of pipes is equal to the input). <BR>If it is 
impossible to fill the given subset, write "Impossible". </DIV>
<DIV align=left><BR><B>Sample test(s)</B></DIV>
<DIV align=left><BR>Input</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>Input 1: <BR>4 4 <BR>1 2 2 0 <BR>2 4 1 1 <BR>1 3 2 1 <BR>3 4 3 0 
<BR>Input 2: <BR>4 4 <BR>1 2 1 0 <BR>2 4 2 1 <BR>1 3 3 1 <BR>3 4 2 0 </DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left><BR>Output</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>Output 1: <BR>3 <BR>1 1 2 2 <BR>Output 2: <BR>Impossible </DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left>
<DIV align=right><A href="http://acm.sgu.ru/submit.php?problem=176">[submit]</A> 
</DIV></DIV>
<DIV align=left>
<DIV align=right><A 
href="http://acm.sgu.ru/forum.php?contest=0&amp;problem=176">[forum]</A> 
</DIV></DIV>
<DIV align=left>
<HR>
</DIV>
<TABLE cellSpacing=7 align=left>
  <TBODY>
  <TR>
    <TD>Author:</TD>
    <TD>Dmitry Orlov </TD></TR>
  <TR>
    <TD>Resource:</TD>
    <TD>Saratov ST team Spring Contest #1 </TD></TR>
  <TR>
    <TD>Date:</TD>
    <TD>18.05.2003 
</TD></TR></TBODY></TABLE><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR>
<TABLE class=tb cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD>
      <TABLE cellSpacing=1 width="100%">
        <TBODY>
        <TR>
          <TD bgColor=#ffffff>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR style="BACKGROUND-COLOR: #ffffff">
                <TD align=left>Server time: 2004-01-14 06:39:06</TD>
                <TD align=right><A href="mailto:acm@cs.sgu.ru" 
                  target=_top>Online Contester</A> Team © 2002 - 2003. All 
                  rights 
  reserved.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV></BODY></HTML>
