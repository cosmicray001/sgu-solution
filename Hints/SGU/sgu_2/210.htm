<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=210 -->
<HTML><HEAD><TITLE>Saratov State University :: Online Contester</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<META content=??? name=keywords>
<META content=??? name=description><LINK href="210.files/style-800.css" 
type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2716.2200" name=GENERATOR></HEAD>
<BODY style="FONT-SIZE: 9pt" text=#000000 vLink=#336699 aLink=#336699 
link=#336699 bgColor=#f3f6f9>
<DIV align=center>
<DIV align=center>
<H4>210. Beloved Sons </H4></DIV>
<DIV align=center>time limit per test: 2 sec.<BR>memory limit per test: 65536 
KB</DIV>
<DIV align=center>input: standard<BR>output: standard</DIV><BR><BR><BR>
<DIV align=left>Once upon a time there lived a king and he had N sons. And the 
king wanted to marry his beloved sons on the girls that they did love. So one 
day the king asked his sons to come to his room and tell him whom do they love. 
<BR><BR>But the sons of the king were all young men so they could not tell 
exactly whom they did love. Instead of that they just told him the names of the 
girls that seemed beautiful to them, but since they were all different, their 
choices of beautiful girls also did not match exactly. <BR><BR>The king was 
wise. He did write down the information that the children have provided him with 
and called you, his main wizard. <BR><BR>"I want all my kids to be happy, you 
know," he told you, "but since it might be impossible, I want at least some of 
them to marry the girl they like. So please, prepare the marriage list." 
<BR><BR>Suddenly you recalled that not so long ago the king told you about each 
of his sons, so you knew how much he loves him. So you decided to please the 
king and make such a marriage list that the king would be most happy. You know 
that the happiness of the king will be proportional to the square root of the 
sum of the squares of his love to the sons that would marry the girls they like. 
<BR><BR>So, go on, make a list to maximize the king's happiness. <BR></DIV>
<DIV align=left><BR><B>Input</B></DIV>
<DIV align=left><BR>The first line of the input file contains N — the number of 
king's sons (1 &#8804; N &#8804; 400). The second line contains N integer numbers 
A<SUB>i</SUB> ranging from 1 to 1000 — the measures of king's love to each of 
his sons. <BR><BR>Next N lines contain lists of king's sons' preferences — first 
K<SUB>i</SUB> — the number of the girls the i-th son of the king likes, and then 
K<SUB>i</SUB> integer numbers — the girls he likes (all potentially beautiful 
girls in the kingdom were numbered from 1 to N, you know, beautiful girls were 
rare in those days). <BR></DIV>
<DIV align=left><BR><B>Output</B></DIV>
<DIV align=left><BR>Output N numbers — for each son output the number of the 
beautiful girl he must marry or 0 if he must not marry the girl he likes. 
<BR><BR>Denote the set of sons that marry a girl they like by L, then you must 
maximize the value of <BR>
<CENTER><BR>sqrt( sum(i from L, A<SUB>i</SUB><SUP>2</SUP>) ) 
<BR></CENTER><BR></DIV>
<DIV align=left><BR><B>Sample test(s)</B></DIV>
<DIV align=left><BR>Input</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>4 <BR>1 3 2 4 <BR>4 1 2 3 4 <BR>2 1 4 <BR>2 1 4 <BR>2 1 4 
<BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left><BR>Output</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>2 1 0 4 <BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left>
<DIV align=right><A href="http://acm.sgu.ru/submit.php?problem=210">[submit]</A> 
</DIV></DIV>
<DIV align=left>
<DIV align=right><A 
href="http://acm.sgu.ru/forum.php?contest=0&amp;problem=210">[forum]</A> 
</DIV></DIV>
<DIV align=left>
<HR>
</DIV>
<TABLE cellSpacing=7 align=left>
  <TBODY>
  <TR>
    <TD>Author:</TD>
    <TD>Andrew Stankevich </TD></TR>
  <TR>
    <TD>Resource:</TD>
    <TD>Petrozavodsk Summer Trainings 2003 </TD></TR>
  <TR>
    <TD>Date:</TD>
    <TD>2003-08-30 
</TD></TR></TBODY></TABLE><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR>
<TABLE class=tb cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD>
      <TABLE cellSpacing=1 width="100%">
        <TBODY>
        <TR>
          <TD bgColor=#ffffff>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR style="BACKGROUND-COLOR: #ffffff">
                <TD align=left>Server time: 2004-01-14 13:41:09</TD>
                <TD align=right><A href="mailto:acm@cs.sgu.ru" 
                  target=_top>Online Contester</A> Team © 2002 - 2003. All 
                  rights 
  reserved.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV></BODY></HTML>
