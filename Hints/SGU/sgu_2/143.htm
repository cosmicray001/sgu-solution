<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=143 -->
<HTML><HEAD><TITLE>143. Long Live the Queen</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<META http-equiv=Expires content=Дата>
<META http-equiv=Cache-Control content=no-cache>
<META http-equiv=pragma content=no-cache>
<META 
content="ACM, programming contest, programming, contest, informatics, ioi, saratov, ICPC, программирование, информатика, алгоритм, саратов, контест" 
name=keywords>
<META 
content="That site consists of some amount of programming problems. Online Contester system check your solution right now. You can participate in programming contests. Train your programming skills." 
name=description><LINK href="style.css" type=text/css rel=stylesheet>
<STYLE type=text/css>TD {
	FONT-SIZE: 9pt
}
</STYLE>

<META content="MSHTML 6.00.2716.2200" name=GENERATOR></HEAD>
<BODY>
<TABLE width="95%">
  <TBODY>
  <TR>
    <TD>
      <H3><B>
      <P align=center>143. Long Live the Queen </P></H3></B>
      <P align=center>Time Limit: 0.2 sec, Memory Limit: 1 MB </P>
      <P align=justify></P>
      <P align=justify>The Queen of Byteland is very loved by her people. In 
      order to show her their love, the Bytelanders have decided to conquer a 
      new country which will be named according to the queen's name. This new 
      country contains <B>N</B> towns. The towns are connected by bidirectional 
      roads and there is exactly <B>ONE</B> path between any two towns, walking 
      on the country's roads. For each town, the profit it brings to the owner 
      is known. Although the Bytelanders love their queen very much, they don't 
      want to conquer all the <B>N</B> towns for her. They will be satisfied 
      with a non-empty subset of these towns, with the following <B>2</B> 
      properties: there exists a path from every town in the subset to every 
      other town in the subset walking only through towns in the subset and the 
      profit of the subset is maximum. The profit of a subset of the <B>N</B> 
      towns is equal to the sum of the profits of the towns which belong to the 
      subset. Your task is to find the maximum profit the Bytelanders may get. 
      </P>
      <P align=justify></P><B>
      <P align=justify>Input</P></B>
      <P align=justify>The first line of input will contain the number of towns 
      <B>N (1&lt;=N&lt;=16 000)</B>. The second line will contain <B>N</B> 
      integers: the profits for each town, from <B>1</B> to <B>N</B>. Each 
      profit is an integer number between <B>-1000</B> and <B>1000</B>. The next 
      <B>N-1</B> lines describe the roads: each line contains <B>2</B> integer 
      numbers <B>a</B> and <B>b</B>, separated by blanks, denoting two different 
      towns between which there exists a road. </P>
      <P align=justify></P><B>
      <P align=justify>Output</P></B>
      <P align=justify>The output should contain one integer number: the maximum 
      profit the Bytelanders may get. </P>
      <P align=justify></P>
      <P align=justify>Sample Input</P><FONT face="Courier New"><PRE>5
-1 1 3 1 -1
4 1
1 3
1 2
4 5
</PRE>
      <P align=justify></P></FONT>
      <P align=justify>Sample Output</P><FONT face="Courier New"><PRE>4
</PRE></FONT></TD></TR>
  <TR>
    <TD>
      <HR>

      <TABLE align=left>
        <TBODY>
        <TR>
          <TD>Author</TD>
          <TD>: Mugurel Ionut Andreica</TD></TR>
        <TR>
          <TD>Resource</TD>
          <TD>: SSU::Online Contester Fall Contest #2</TD></TR>
        <TR>
          <TD>Date</TD>
          <TD>: Fall 
2002</TD></TR></TD></TR></TBODY></TABLE></TR></TBODY></TABLE></BODY></HTML>
