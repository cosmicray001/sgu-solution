<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=213 -->
<HTML><HEAD><TITLE>Saratov State University :: Online Contester</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<META content=??? name=keywords>
<META content=??? name=description><LINK href="213.files/style-800.css" 
type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2716.2200" name=GENERATOR></HEAD>
<BODY style="FONT-SIZE: 9pt" text=#000000 vLink=#336699 aLink=#336699 
link=#336699 bgColor=#f3f6f9>
<DIV align=center>
<DIV align=center>
<H4>213. Strong Defence </H4></DIV>
<DIV align=center>time limit per test: 2 sec.<BR>memory limit per test: 65536 
KB</DIV>
<DIV align=center>input: standard<BR>output: standard</DIV><BR><BR><BR>
<DIV align=left>The Chief of the Galactic Empire has recently received some bad 
news from his spies. The Dark Lord is preparing to attack the Empire. His fleet 
of spaceships is ready for the first hyperjump. <BR><BR>It is well known that 
travelling in space is very simple. You just start from some star and make a 
series of hyperjumps to other stars. You can only jump from one star to another 
if they are connected with a special hyperjump tunnel, which is bidirectional, 
thus allowing to make a jump from one star that it connects to another. Of 
course, the tunnels are designed in such a way that there is the way to get from 
each star to any other one. <BR><BR>However, there is the way to block the 
hyperjump — to do this one must put a special battleship in the corresponding 
hypertunnel. <BR><BR>Of course, the Chief would like to block all hyperpaths 
from the star where the headquaters of the Dark Lord are located to the star 
where the capital of the Galactic Empire is. The resources of the Empire are 
almost unbounded, so it is easy to create as many battleships as needed. 
Unfortunately, there is one problem. <BR><BR>Each hyperjump blocking battleship 
must have a special crystal on board which allows him to stay in the hyperspace. 
There is a number of types of such crystals. The problem is that there is the 
way to destroy all battleships carrying some particular type of crystal. 
<BR><BR>Although it is known, that for each crystal type there is the way to 
destroy battleships powered by this crystal, there is hope that not all of those 
are known to Dark Lord engineers. So the Chief would like to use blocking ships 
in such a way that the following conditions are satisfied: <BR>
<UL><BR>
  <LI>for each crystal type, if all ships with other crystal types are 
  destroyed, battle ships with this crystal type block hypertunnels in such a 
  way, that there is no path from Dark Lord's star to Empire Capital star; <BR>
  <LI>the number of different crystal types used in ships is maximal possible; 
  <BR>
  <LI>no two ships block the same hypertunnel. <BR></LI></UL><BR>You may consider 
that there is the unlimited number of crystal types available and crystals of 
each type available. <BR></DIV>
<DIV align=left><BR><B>Input</B></DIV>
<DIV align=left><BR>The first line of the input file contains N — the number of 
stars in the Galaxy(2 &#8804; N &#8804; 400), M -- the number of tunnels, S and T — numbers 
of stars where Dark Lord headquaters and Empire Capital are located respectively 
(S &#8800; T). <BR><BR>Next M lines contain two integer numbers each — the numbers of 
the stars the corresponding tunnel connects. No tunnel connects a star to 
itself, no two stars are connected with more than one tunnel. <BR><BR></DIV>
<DIV align=left><BR><B>Output</B></DIV>
<DIV align=left><BR>First output L — the number of crystal types used. After 
that output L lines, for each crystal type output first K<SUB>i</SUB> — the 
number of battleships with this crystal used, and then K<SUB>i</SUB> numbers, 
identifying the hypertunnels blocked by the corresponding battleship. The 
tunnels are numbered starting from 1, as they are given in the input file. 
<BR></DIV>
<DIV align=left><BR><B>Sample test(s)</B></DIV>
<DIV align=left><BR>Input</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>4 4 1 4 <BR>1 2 <BR>1 3 <BR>2 4 <BR>3 4 <BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left><BR>Output</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>2 <BR>2 1 2 <BR>2 3 4 <BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left>
<DIV align=right><A href="http://acm.sgu.ru/submit.php?problem=213">[submit]</A> 
</DIV></DIV>
<DIV align=left>
<DIV align=right><A 
href="http://acm.sgu.ru/forum.php?contest=0&amp;problem=213">[forum]</A> 
</DIV></DIV>
<DIV align=left>
<HR>
</DIV>
<TABLE cellSpacing=7 align=left>
  <TBODY>
  <TR>
    <TD>Author:</TD>
    <TD>Andrew Stankevich </TD></TR>
  <TR>
    <TD>Resource:</TD>
    <TD>Petrozavodsk Summer Trainings 2003 </TD></TR>
  <TR>
    <TD>Date:</TD>
    <TD>2003-08-30 
</TD></TR></TBODY></TABLE><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR>
<TABLE class=tb cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD>
      <TABLE cellSpacing=1 width="100%">
        <TBODY>
        <TR>
          <TD bgColor=#ffffff>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR style="BACKGROUND-COLOR: #ffffff">
                <TD align=left>Server time: 2004-01-14 16:18:16</TD>
                <TD align=right><A href="mailto:acm@cs.sgu.ru" 
                  target=_top>Online Contester</A> Team © 2002 - 2003. All 
                  rights 
  reserved.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV></BODY></HTML>
