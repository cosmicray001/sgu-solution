<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=194 -->
<HTML><HEAD><TITLE>Saratov State University :: Online Contester</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<META content=??? name=keywords>
<META content=??? name=description><LINK href="194.files/style-800.css" 
type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2716.2200" name=GENERATOR></HEAD>
<BODY style="FONT-SIZE: 9pt" text=#000000 vLink=#336699 aLink=#336699 
link=#336699 bgColor=#f3f6f9>
<DIV align=center>
<DIV align=center>
<H4>194. Reactor Cooling </H4></DIV>
<DIV align=center>time limit per test: 2 sec.<BR>memory limit per test: 65536 
KB</DIV>
<DIV align=center>input: standard<BR>output: standard</DIV><BR><BR><BR>
<DIV align=left>The terrorist group leaded by a well known international 
terrorist Ben Bladen is buliding a nuclear reactor to produce plutonium for the 
nuclear bomb they are planning to create. Being the wicked computer genius of 
this group, you are responsible for developing the cooling system for the 
reactor. <BR><BR>The cooling system of the reactor consists of the number of 
pipes that special cooling liquid flows by. Pipes are connected at special 
points, called nodes, each pipe has the starting node and the end point. The 
liquid must flow by the pipe from its start point to its end point and not in 
the opposite direction. <BR><BR>Let the nodes be numbered from 1 to N. The 
cooling system must be designed so that the liquid is circulating by the pipes 
and the amount of the liquid coming to each node (in the unit of time) is equal 
to the amount of liquid leaving the node. That is, if we designate the amount of 
liquid going by the pipe from i-th node to j-th as f<SUB>ij</SUB>, (put 
f<SUB>ij</SUB> = 0 if there is no pipe from node i to node j), for each i the 
following condition must hold: <BR><BR>
<CENTER><BR>sum(j=1..N, f<SUB>ij</SUB>) = sum(j=1..N, f<SUB>ji</SUB>) 
<BR></CENTER><BR><BR>Each pipe has some finite capacity, therefore for each i 
and j connected by the pipe must be f<SUB>ij</SUB> &#8804; c<SUB>ij</SUB> where 
c<SUB>ij</SUB> is the capacity of the pipe. To provide sufficient cooling, the 
amount of the liquid flowing by the pipe going from i-th to j-th nodes must be 
at least l<SUB>ij</SUB>, thus it must be f<SUB>ij</SUB> &#8805; l<SUB>ij</SUB>. 
<BR><BR>Given c<SUB>ij</SUB> and l<SUB>ij</SUB> for all pipes, find the amount 
f<SUB>ij</SUB>, satisfying the conditions specified above. <BR></DIV>
<DIV align=left><BR><B>Input</B></DIV>
<DIV align=left><BR>The first line of the input file contains the number N (1 &#8804; 
N &#8804; 200) - the number of nodes and and M — the number of pipes. The following M 
lines contain four integer number each - i, j, l<SUB>ij</SUB> and c<SUB>ij</SUB> 
each. There is at most one pipe connecting any two nodes and 0 &#8804; l<SUB>ij</SUB> 
&#8804; c<SUB>ij</SUB> &#8804; 10<SUP>5</SUP> for all pipes. No pipe connects a node to 
itself. If there is a pipe from i-th node to j-th, there is no pipe from j-th 
node to i-th. <BR></DIV>
<DIV align=left><BR><B>Output</B></DIV>
<DIV align=left><BR>On the first line of the output file print YES if there is 
the way to carry out reactor cooling and NO if there is none. In the first case 
M integers must follow, k-th number being the amount of liquid flowing by the 
k-th pipe. Pipes are numbered as they are given in the input file. <BR></DIV>
<DIV align=left><BR><B>Sample test(s)</B></DIV>
<DIV align=left><BR>Input</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>Test #1 <BR><BR>4 6 <BR>1 2 1 2 <BR>2 3 1 2 <BR>3 4 1 2 <BR>4 1 
1 2 <BR>1 3 1 2 <BR>4 2 1 2 <BR><BR>Test #2 <BR><BR>4 6 <BR>1 2 1 3 <BR>2 3 1 3 
<BR>3 4 1 3 <BR>4 1 1 3 <BR>1 3 1 3 <BR>4 2 1 3 <BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left><BR>Output</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>Test #1 <BR><BR>NO <BR><BR>Test #2 <BR><BR>YES <BR>1 <BR>2 <BR>3 
<BR>2 <BR>1 <BR>1 <BR><BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left>
<DIV align=right><A href="http://acm.sgu.ru/submit.php?problem=194">[submit]</A> 
</DIV></DIV>
<DIV align=left>
<DIV align=right><A 
href="http://acm.sgu.ru/forum.php?contest=0&amp;problem=194">[forum]</A> 
</DIV></DIV>
<DIV align=left>
<HR>
</DIV>
<TABLE cellSpacing=7 align=left>
  <TBODY>
  <TR>
    <TD>Author:</TD>
    <TD>Andrew Stankevich </TD></TR>
  <TR>
    <TD>Resource:</TD>
    <TD>Petrozavodsk Winter Trainings 2003 </TD></TR>
  <TR>
    <TD>Date:</TD>
    <TD>2003-02-06 
</TD></TR></TBODY></TABLE><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR>
<TABLE class=tb cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD>
      <TABLE cellSpacing=1 width="100%">
        <TBODY>
        <TR>
          <TD bgColor=#ffffff>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR style="BACKGROUND-COLOR: #ffffff">
                <TD align=left>Server time: 2004-01-14 12:14:57</TD>
                <TD align=right><A href="mailto:acm@cs.sgu.ru" 
                  target=_top>Online Contester</A> Team © 2002 - 2003. All 
                  rights 
  reserved.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV></BODY></HTML>
