<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=195 -->
<HTML><HEAD><TITLE>Saratov State University :: Online Contester</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<META content=??? name=keywords>
<META content=??? name=description><LINK href="195.files/style-800.css" 
type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2716.2200" name=GENERATOR></HEAD>
<BODY style="FONT-SIZE: 9pt" text=#000000 vLink=#336699 aLink=#336699 
link=#336699 bgColor=#f3f6f9>
<DIV align=center>
<DIV align=center>
<H4>195. New Year Bonus Grant </H4></DIV>
<DIV align=center>time limit per test: 4 sec.<BR>memory limit per test: 65536 
KB</DIV>
<DIV align=center>input: standard<BR>output: standard</DIV><BR><BR><BR>
<DIV align=left>All programmers of <EM>Mocrosoft</EM> software company are 
organized in a strict subordination hierarchy. Every programmer has exactly one 
chief, except Bill Hates who is also the head of the company and has no chief. 
<BR><BR>Due to the celebration of the new 2003 year, chief accountant of 
<EM>Mocrosoft</EM> decided to pay a New Year Bonus Grant of 1000 dollars to some 
programmers. However being extremely concerned of the company wealth she would 
like to designate the least possible amount of money for these grants. On the 
other hand she didn't want to be accused of being too greedy or of giving 
preferences to some programmers. To do this, she developed the following scheme 
of grants appointment: <BR><BR>
<UL><BR>
  <LI>Each programmer may either assign a grant to one of his subordinates or 
  have a grant assigned to him by his chief or none of the above. <BR>
  <LI>No programmer can simultaneously receive a grant and assign a grant to one 
  of his subordinates. <BR>
  <LI>No programmer can assign a grant to more than one of his subordinates 
  <BR></LI></UL><BR><BR>The scheme seemed to be designed perfectly — nobody would 
like to assign a grant to anybody since in this case he himself would not 
receive money. But programmers somehow discovered the plan of chief accountant 
and decided to make a trick to get the most money possible and share them fairly 
afterwards. The idea was to make such grant assignments that the total amount of 
grant money received is maximum possible. <BR><BR>You were selected to write the 
program which will find the optimal grants appointment. <BR></DIV>
<DIV align=left><BR><B>Input</B></DIV>
<DIV align=left><BR>The first line of the input file contains integer N — the 
number of programmers in <EM>Mocrosoft</EM> company (2 &#8804; N &#8804; 500 000). Each 
programmer is assigned his unique identifier — integer number ranging from 1 to 
N. Bill Hates has number 1 and each programmer has the number greater then the 
number of his chief. The second line of the input file contains N-1 integers, 
i-th of which being the number of the chief of the worker whose number is (i + 
1). <BR></DIV>
<DIV align=left><BR><B>Output</B></DIV>
<DIV align=left><BR>On the first line of the output file print the maximum 
possible amount of money workers can get. On the second line output the numbers 
of programmers that will receive grant in ascending order. <BR></DIV>
<DIV align=left><BR><B>Sample test(s)</B></DIV>
<DIV align=left><BR>Input</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>4 <BR>1 1 2 <BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left><BR>Output</DIV>
<DIV align=left><FONT face="Courier New"></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left>2000 <BR>3 4 <BR><BR></DIV>
<DIV align=left><PRE></PRE></DIV>
<DIV align=left></FONT></DIV>
<DIV align=left>
<DIV align=right><A href="http://acm.sgu.ru/submit.php?problem=195">[submit]</A> 
</DIV></DIV>
<DIV align=left>
<DIV align=right><A 
href="http://acm.sgu.ru/forum.php?contest=0&amp;problem=195">[forum]</A> 
</DIV></DIV>
<DIV align=left>
<HR>
</DIV>
<TABLE cellSpacing=7 align=left>
  <TBODY>
  <TR>
    <TD>Author:</TD>
    <TD>Andrew Stankevich </TD></TR>
  <TR>
    <TD>Resource:</TD>
    <TD>Petrozavodsk Winter Trainings 2003 </TD></TR>
  <TR>
    <TD>Date:</TD>
    <TD>2003-02-06 
</TD></TR></TBODY></TABLE><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR>
<TABLE class=tb cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD>
      <TABLE cellSpacing=1 width="100%">
        <TBODY>
        <TR>
          <TD bgColor=#ffffff>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR style="BACKGROUND-COLOR: #ffffff">
                <TD align=left>Server time: 2004-01-14 12:17:23</TD>
                <TD align=right><A href="mailto:acm@cs.sgu.ru" 
                  target=_top>Online Contester</A> Team © 2002 - 2003. All 
                  rights 
  reserved.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV></BODY></HTML>
